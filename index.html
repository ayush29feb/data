<!DOCTYPE html>
<html>
  <head>
    <title>Single View NeRF Metric Visualizations</title>
    <script src="https://cdn.jsdelivr.net/npm/vega@5.20.2"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.1.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.17.0"></script>
  </head>
  <body>
    <div id="bar"></div>
    <div id="percentile"></div>
    <div id="trellis"></div>
    <div id="heatmap"></div>

    <script type="text/javascript">
      var url="https://raw.githubusercontent.com/ayush29feb/data/master/vega-metrics/data3.json"
      var method = ["gt_warp", "ours", "shih", "photo3d", "si_mpi", "synsin"];
      var barSpec = {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
        "data": {
          "url": url
        },
        "transform": [
          {"fold": method}
        ],
        "resolve":{
          "scale":{
            "y":"independent"
          }
        },
        "facet": {
          "row": {"field": "dataset"},
          "column": {"field": "metric"}
        },
        "spec": {
          "mark": {"type": "bar", "tooltip": {"content": "data"}},
          "encoding": {
            "y": {"field": "value", "type": "quantitative", "title": null, "aggregate": "median"},
            "x": {"field": "key", "type": "nominal", "title": "Method"},
            "color": {"field": "key", "type": "nominal", "title": "Method"}
          }
        }
      };
      var percentileSpec = {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
        "data": {
          "url": url
        },
        "transform": [
          {"fold": method},
          {
            "window": [{
              "op": "count",
              "field": "value",
              "as": "count_value"
            }],
            "sort": [{"field": "value", "order": "ascending"}],
            "groupby": ["dataset", "key", "metric"],
            "ignorePeers": false,
            "frame": [null, 0]
          }
        ],
        "resolve":{
          "scale":{
            "y":"independent"
          }
        },
        "facet": {
          "row": {"field": "dataset"},
          "column": {"field": "metric"}
        },
        "spec": {
          "mark": {"type": "line", "tooltip": {"content": "data"}},
          "encoding": {
            "color": {"field": "key", "type": "nominal", "title": "Method"},
            "y": {"field": "value", "type": "quantitative", "title": null},
            "x": {"field": "count_value", "type": "quantitative", "title": "#samples"}
          }
        }
      };

      var trellisSpec = {
        "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
        "data": { "url": url },
        "transform": [
          {"fold": methods}
        ],
        "facet": {
          "column": {
            "field": "metric",
            "type": "nominal",
          },
          "row": {
            "field": "dataset",
            "type": "nominal"
          }
        },
        "resolve":{
          "scale":{
            "x": "independent"
          }
        },
        "spec": {
          "mark": {"type": "circle", "tooltip": {"content": "data"}},
          "encoding": {
            "color": {"field": "key", "type":"nominal"},
            "x": {"field": "value", "type": "quantitative", "scale": {}},
            "y": {"field": "pair", "type": "ordinal"}
          }
        }
      };
      vegaEmbed('#bar', barSpec);
      vegaEmbed('#percentile', percentileSpec);
      vegaEmbed('#trellis', trellisSpec);
      // vegaEmbed('#heatmap', heatmapSpec);
    </script>
  </body>
</html>
